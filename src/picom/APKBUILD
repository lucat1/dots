pkgname=picom-fork
pkgver=1
pkgrel=0
pkgdesc="X Compositor (a fork of compton)"
url="https://github.com/sdhand/picom"
arch="all"
license="MIT MPL-2.0"
makedepends="libx11-dev libxcomposite-dev libxinerama-dev libxdamage-dev
	libconfig-dev pcre-dev libxrandr-dev dbus-dev libdrm-dev mesa-dev meson
	libev-dev libxdg-basedir-dev pixman-dev xcb-util-renderutil-dev
	xcb-util-image-dev asciidoc uthash-dev"
subpackages="$pkgname-doc"
source="picom-next.tar.gz::https://github.com/sdhand/picom/archive/next.tar.gz"
options="!check" # No tests defined in tests/ directory

replaces="compton" # Backwards compatibility
provides="compton=$pkgver-r$pkgrel" # Backwards compatibility

build() {
  cd picom-next
	meson --prefix=/usr --buildtype=plain -Dbuild_docs=true build
	ninja -v -C build
}

package() {
  cd src/picom-next
	DESTDIR="$pkgdir" ninja -C build install

	mkdir -p "$pkgdir/usr/share/doc/picom"
	install -m644 README* "$pkgdir/usr/share/doc/picom/"
	install -D -m644 "picom.sample.conf" "$pkgdir/etc/xdg/picom.conf.example"
}

sha512sums="c4f9a759ae2beb43e61d03d29b4153934cb9381ee2fa053660ef4edef67668697c67402703092655caccb2f806fbb0e7b07500d7659085ed41fabda5e42f4ba6  picom-next.tar.gz"
