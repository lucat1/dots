pkgname=dmenu-fork
pkgver=4.8
pkgrel=0
pkgdesc="Dynamic menu for X"
url="https://tools.suckless.org/dmenu/"
arch="all"
license="MIT"
depends=""
depends_dev=""
makedepends="libx11-dev libxinerama-dev libxft-dev"
install=""
options="!check"
subpackages="$pkgname-doc"
source="https://dl.suckless.org/tools/dmenu-$pkgver.tar.gz dmenu.c config.h dmenu_run"
builddir="$srcdir"/dmenu-$pkgver

prepare() {
	default_prepare
	sed -i -e '/CFLAGS/{s/-Os//;s/=/+=/}' \
		-e '/LDFLAGS/{s/-s//;s/=/+=/}' \
		"$builddir"/config.mk
  
  cp ../dmenu.c .
  cp ../config.h .
}

build() {
	make X11INC=/usr/include/X11 \
		X11LIB=/usr/lib/X11 \
		FREETYPEINC=/usr/include/freetype2 \
		-C "$builddir"
}

package() {
  cp ../dmenu_run .
	make DESTDIR=$pkgdir PREFIX=/usr \
		-C "$builddir" install
}

sha512sums="fa2700018cfb912a21f867ef3ca771a58a25c2cb8e1fb37acef046bb15d8d8b92dcc5bfce486befae0f143495d0283910988e181a9eb143be3bb1b5be9738d77  dmenu-4.8.tar.gz
8ea88cc94bab0e7b70cc5e3af995d3ee49539a2e764cd7dce495424d81108ea8e260d84269d7c8054dd83796fdcaf2d08c235899b5e0ecdca181c7d2f4eafe02  dmenu.c
ca7a86f9e660dd237a17251993d5e4c5247eefc9cef4a3c2493d5b5710bb6efb6daf645600617542abddc9bde2c523a05444c275526e9c2352b6c3fbaf4d76d1  config.h
1a4e857f1330eeb99b5284d2dae27b233c8331eb3adf5663e19c6619d01cff59f3962553681022672eb452141ddf4a40a181bc8b524bc14a94f46b745e5add73  dmenu_run"
